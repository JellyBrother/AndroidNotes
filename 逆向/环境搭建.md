# 环境搭建

## Android studio日志台乱码

\-Dfile.encoding=UTF-8

## git乱码

C:\Users\admin\.gitconfig

    [user]
    	name = liuguodong
    	email = liuguodong@vmos.cn
    [credential "helperselector"]
    	selected = manager-core
    [credential "http://192.168.22.202:3000"]
    	provider = generic
    [credential "https://git.vmos.pro"]
    	provider = generic
    
    [gui]  
        encoding = utf-8  
        # 代码库统一使用utf-8  
    [i18n]  
        commitencoding = utf-8  
        # log编码  
    [svn]  
        pathnameencoding = utf-8  
        # 支持中文路径  
    [core]
        quotepath = false 
        # status引用路径不再是八进制（反过来说就是允许显示中文了）

## 办公软件

搜狗输入法、钉钉、7z压缩、浏览器

亿图：[https://www.edrawsoft.cn/](https://www.edrawsoft.cn/)

gif采集（GifCam）：[https://blog.bahraniapps.com/gifcam/#download](https://blog.bahraniapps.com/gifcam/#download)  [https://zhuanlan.zhihu.com/p/28342393](https://zhuanlan.zhihu.com/p/28342393)

## 开发软件

Android studio、BeyondCompare、DB.Browser.for.SQLite、Everything、Git、notepad、node、scrcpy、VSCodeUserSetup、Postman、python-3.10.3

Android studio： [https://developer.android.com/studio](https://developer.android.com/studio)

BeyondCompare： [https://www.beyondcompare.cc/xiazai.html](https://www.beyondcompare.cc/xiazai.html)

DB.Browser.for.SQLite： [https://sqlitebrowser.org/](https://sqlitebrowser.org/)

Git： [https://git-scm.com/](https://git-scm.com/)

notepad： [http://www.notepadplus.com.cn/](http://www.notepadplus.com.cn/)

node： [https://nodejs.org/en](https://nodejs.org/en)

scrcpy： [https://github.com/Genymobile/scrcpy/blob/master/doc/windows.md](https://github.com/Genymobile/scrcpy/blob/master/doc/windows.md)

VSCodeUserSetup： [https://code.visualstudio.com/download](https://code.visualstudio.com/download)

Postman：

[https://www.postman.com/](https://www.postman.com/)

[https://www.apifox.com/?utm\_source=google\_search&utm\_medium=g&utm\_campaign=15676663585&utm\_content=131096021026&utm\_term=postman&gclid=CjwKCAjwzuqgBhAcEiwAdj5dRtth0AnbB1nUGZ5fD9Wd3GgR2Hn1q-BDEfKuB8ZD42EH-MYOIQ5JOBoC5cgQAvD\_BwE](https://www.apifox.com/?utm_source=google_search&utm_medium=g&utm_campaign=15676663585&utm_content=131096021026&utm_term=postman&gclid=CjwKCAjwzuqgBhAcEiwAdj5dRtth0AnbB1nUGZ5fD9Wd3GgR2Hn1q-BDEfKuB8ZD42EH-MYOIQ5JOBoC5cgQAvD_BwE)

Ci/Cd工具(流水线构建)：

Jenkins

[https://blog.csdn.net/qq\_40021015/article/details/122664046](https://blog.csdn.net/qq_40021015/article/details/122664046)

hook 工具：

python： \[[https://www.python.org/](https://www.python.org/)\]([https://www.python.org/](https://www.python.org/))

ida：是一款世界顶级的交互式反汇编工具，主要用在反汇编和动态调试等方面，支持对多种处理器的不同类型的可执行模块进行反汇编处理，具有方便直观的操作界面，可以为用户呈现尽可能接近源代码的代码，减少了反汇编工作的难度，提高了效率。

[https://blog.csdn.net/m0\_57485346/article/details/127673843](https://blog.csdn.net/m0_57485346/article/details/127673843)

jadx-gui： \[[https://github.com/skylot/jadx](https://github.com/skylot/jadx)\]([https://github.com/skylot/jadx](https://github.com/skylot/jadx))

jeb： \[[https://www.pnfsoftware.com/](https://www.pnfsoftware.com/)\]([https://www.pnfsoftware.com/](https://www.pnfsoftware.com/))

dex2jar：\[[https://github.com/pxb1988/dex2jar](https://github.com/pxb1988/dex2jar)\]([https://github.com/pxb1988/dex2jar](https://github.com/pxb1988/dex2jar))

jd-gui： \[[https://github.com/java-decompiler/jd-gui](https://github.com/java-decompiler/jd-gui)\]([https://github.com/java-decompiler/jd-gui](https://github.com/java-decompiler/jd-gui))

Malcat：是一款功能丰富的十六进制编辑器/反汇编程序，适用于Windows和Linux，面向IT安全专业人员。

检查数十种二进制文件格式，分解和反编译不同的CPU架构，提取嵌入式文件，并在快速易用的图形界面中扫描Yara签名或异常。

[https://www.52pojie.cn/thread-1682596-1-1.html](https://www.52pojie.cn/thread-1682596-1-1.html)

frida是平台原生app的Greasemonkey，说的专业一点，就是一种动态插桩工具，可以插入一些代码到原生app的内存空间去，（动态地监视和修改其行为），这些原生平台可以是Win、Mac、Linux、Android或者iOS。

[https://blog.csdn.net/tangsilian/article/details/105013936](https://blog.csdn.net/tangsilian/article/details/105013936)

源码查看网站：

[https://mirrors.tuna.tsinghua.edu.cn/help/AOSP/](https://mirrors.tuna.tsinghua.edu.cn/help/AOSP/)

[https://cs.android.com/](https://cs.android.com/)

[https://cs.android.com/android/platform/superproject/?hl=zh-cn](https://cs.android.com/android/platform/superproject/?hl=zh-cn)

[https://android.googlesource.com/](https://android.googlesource.com/)

[http://aospxref.com/android-11.0.0\_r21/](http://aospxref.com/android-11.0.0_r21/)

## Android studio的插件

[https://plugins.jetbrains.com/plugin/164-ideavim](https://plugins.jetbrains.com/plugin/164-ideavim)

AndroidSourceViewer、drawable\_preview、

## Vs插件

[https://marketplace.visualstudio.com/search?target=VSCode&category=Other&sortBy=Installs](https://marketplace.visualstudio.com/search?target=VSCode&category=Other&sortBy=Installs)

ChatGPT、Remote - SSH、

## 第三方框架

[MMKV](https://github.com/Tencent/MMKV)读写替换SharedPreferences：[https://github.com/Tencent/MMKV](https://github.com/Tencent/MMKV)

安卓隐藏api绕过可以反射：[https://github.com/LSPosed/AndroidHiddenApiBypass](https://github.com/LSPosed/AndroidHiddenApiBypass)

bugly闪退上报：[https://bugly.qq.com/v2/](https://bugly.qq.com/v2/)

网络请求：

[https://github.com/MrZhousf/OkHttp3](https://github.com/MrZhousf/OkHttp3)

日志拦截打印：com.squareup.okhttp3:logging-interceptor

retrofit的2.7.1以上最低支持安卓8.0：[https://github.com/square/retrofit](https://github.com/square/retrofit)

gson解析：https://github.com/google/gson

阿里路由： https://github.com/alibaba/ARouter

[https://github.com/didi/DRouter](https://github.com/didi/DRouter)

RxJava：https://github.com/ReactiveX/RxJava

沉浸式框架：https://github.com/gyf-dev/ImmersionBar

权限请求：https://github.com/getActivity/XXPermissions

Adapter：https://github.com/CymChad/BaseRecyclerViewAdapterHelper

流式布局：https://github.com/google/flexbox-layout

下拉刷新：https://github.com/scwang90/SmartRefreshLayout

banner：https://github.com/youth5201314/banner

room数据存储： https://developer.android.google.cn/jetpack/androidx/releases/room

zxing二维码扫描： https://github.com/zxing/zxing

EventBus:  https://github.com/greenrobot/EventBus

下载器：https://github.com/Justson/Downloader

agentweb： https://github.com/Justson/AgentWeb 

4.1.9之上版本会报错com.just.agentweb.AgentActionFragment cannot be cast to android.app.Activity，需要修改源码

百度统计 https://mtj.baidu.com/static/userguide/book/android/sdk/gradle.html  注意上架隐私政策

工具类：

[https://github.com/Blankj/AndroidUtilCode](https://github.com/Blankj/AndroidUtilCode)

图片加载：

[https://github.com/bumptech/glide](https://github.com/bumptech/glide)

图片选择：

[https://github.com/LuckSiege/PictureSelector](https://github.com/LuckSiege/PictureSelector)

插件化：

[https://blog.csdn.net/chuhe1989/article/details/104622513](https://blog.csdn.net/chuhe1989/article/details/104622513)

360的：[https://github.com/Qihoo360/RePlugin](https://github.com/Qihoo360/RePlugin)

腾讯的：[https://github.com/Tencent/Shadow](https://github.com/Tencent/Shadow)

sp跨进程存储：

[https://github.com/Tencent/MMKV](https://github.com/Tencent/MMKV)

热修复：

[https://juejin.cn/post/6862903004685828110](https://juejin.cn/post/6862903004685828110)

[https://www.aliyun.com/product/hotfix](https://www.aliyun.com/product/hotfix)

[https://github.com/Tencent/tinker](https://github.com/Tencent/tinker)

[https://github.com/eleme/Amigo](https://github.com/eleme/Amigo)

换肤：

[https://juejin.cn/post/7095249661501374478](https://juejin.cn/post/7095249661501374478)

[https://github.com/xfhy/Android-Notes/blob/master/Blogs/Android/%E4%B8%89%E6%96%B9%E5%BA%93%E5%8E%9F%E7%90%86/Android-skin-support%E6%8D%A2%E8%82%A4%E5%8E%9F%E7%90%86%E8%AF%A6%E8%A7%A3.md](https://github.com/xfhy/Android-Notes/blob/master/Blogs/Android/%E4%B8%89%E6%96%B9%E5%BA%93%E5%8E%9F%E7%90%86/Android-skin-support%E6%8D%A2%E8%82%A4%E5%8E%9F%E7%90%86%E8%AF%A6%E8%A7%A3.md)

[https://github.com/ximsfei/Android-skin-support](https://github.com/ximsfei/Android-skin-support)

[https://github.com/fengjundev/Android-Skin-Loader](https://github.com/fengjundev/Android-Skin-Loader)

启动初始化：App Startup

[https://henleylee.github.io/posts/2020/48ae060.html](https://henleylee.github.io/posts/2020/48ae060.html)

### 谷歌：

    登录、地图、短信验证、导航、签名、位置、设置
    implementation 'com.google.android.gms:play-services-fitness:21.1.0'
    implementation 'com.google.android.gms:play-services-auth:20.3.0'
    implementation 'com.google.android.gms:play-services-maps:18.1.0'
    implementation 'com.google.android.gms:play-services-auth-api-phone:18.0.1'
    implementation 'com.google.android.gms:play-services-location:21.0.1'
    // Import the BoM for the Firebase platform
    implementation platform('com.google.firebase:firebase-bom:31.1.1')
    implementation 'com.google.firebase:firebase-messaging'
    implementation 'com.google.firebase:firebase-analytics'
    implementation "com.google.guava:guava:28.1-android"
    implementation 'com.google.api-client:google-api-client:1.30.5'
    implementation 'com.google.api-client:google-api-client-android:1.30.5'
    implementation 'com.google.apis:google-api-services-people:v1-rev99-1.22.0'

### 相机

    Camera1 过时
    import android.hardware.Camera;
    
    Camera2
    import android.hardware.camera2.CameraManager;
    androidx.camera.view.PreviewView
    implementation "androidx.camera:camera-core:1.2.0"
    implementation "androidx.camera:camera-camera2:1.2.0"
    implementation "androidx.camera:camera-lifecycle:1.2.0"
    implementation "androidx.camera:camera-video:1.2.0"
    implementation "androidx.camera:camera-view:1.2.0"
    implementation "androidx.camera:camera-extensions:1.2.0"

### 视频播放

    使用MediaPlayer+SurfaceView
    implementation 'androidx.media:media:1.2.1'
    优化缓存：https://github.com/danikula/AndroidVideoCache
    使用安卓原生：android.widget.VideoView
    播放优化缓存：https://github.com/danikula/AndroidVideoCache

## 安卓安全

jadx看源码，fride写脚本调试，jeb动态调试查看smail，用IDA修改smail值。

逆向环境准备：[https://www.jianshu.com/p/ec043ef9e0c3](https://www.jianshu.com/p/ec043ef9e0c3)

[https://forum.butian.net/share/649](https://forum.butian.net/share/649)

[https://github.com/JakeWharton/dalvik-dx](https://github.com/JakeWharton/dalvik-dx)

[https://github.com/apache/commons-lang](https://github.com/apache/commons-lang)

[https://github.com/rovo89/XposedBridge](https://github.com/rovo89/XposedBridge)

[https://github.com/asLody/SandHook](https://github.com/asLody/SandHook)

[https://gitee.com/id0911/SandHook](https://gitee.com/id0911/SandHook)

[https://blog.csdn.net/ezconn/article/details/111705880](https://blog.csdn.net/ezconn/article/details/111705880)

Magisk：https://github.com/topjohnwu/Magisk

Vxp ：https://github.com/android-hacker/VirtualXposed

Xposed ： https://github.com/rovo89

### 逆向工具

java：dex2jar、jadx、jeb、android-killer等等

so文件：IDA、jeb、Gidra；

### 抓包工具

Charles、Fillder：这两个其实差不多，用于http、websocket等应用层抓包

WireShark：各种协议都能支持，需要更深入的网络协议技术基础

BurpSuite：可以开发一些插件，会开发就各种神操作把。

### hook框架

*   xposed：Android 系统启动的时候， zygote 进程加载 XposedBridge 将所有需要替换的 Method 通过 JNI 方法 hookMethodNative 指向 Native 方法 xposedCallHandler ， xposedCallHandler 在转入 handleHookedMethod 这个 Java 方法执行用户规定的 Hook Func。已经停止维护。
    
*    EdXposed：借助 riru 替换 [libmemtrack.so](https://link.zhihu.com/?target=http%3A//libmemtrack.so) 从而进入 zygote 进程，之后是 sandhook 一类的完成具体逻辑的劫持，并向上包装一层实现对 xposed api的兼容，成为Xposed停止更新后的官方接任者。
    

*   frida：动态插桩工具，可以插入一些代码到原生app的内存空间。
    

官网：[http://www.frida.re/](http://www.frida.re/)

样例：http://www.frida.re/docs/examples/android/

*   cydia：hook Native层的时候多一点，老开发者用的多。
    
*   inlinehook，xhook，Sandhook，Android-lnline-Hook：这两个类似，inlinehook多用于hook b跳转的，xhook多用于系统函数，Inline Hook能Hook几乎所有函数，但是兼容性较差，不能达到上线标准。
    
*   magisk:对系统侵入较少，仅修改boot，同时能够对系统隐藏自身存在，支持OTA升级，可以实现Multirom多系统等功能。
    
*   **CydiaSubstrate**：c++代码，在JNI层做HOOK，而且实现出的应用可以单独使用。
    

官网：http://www.cydiasubstrate.com/

*   **ratel**：Android逆向分析工具套件，提供了⼀系列渐进式app逆向分析工具，平头哥也是⼀个app⼆次开发的沙箱环境，支持在免root环境下hook和重定义app功能。
    
*   VirtualApp：它去启动别的App，在启动过程中通过 epic Hook本进程，从而控制被启动的App
    

https://github.com/asLody/VirtualApp

[https://www.jianshu.com/p/ce2f26f4b03b](https://www.jianshu.com/p/ce2f26f4b03b)

*   PLT/Got：通过解析SO文件，将待hook函数在got表的地址替换为自己函数的入口地址，这样目标进程每次调用待hook函数时，实际上是执行了我们自己的函数。
    
*   Unicorn：模拟CPU，可以实现很多强大的功能，也可以实现函数级别的Hook。
    
*   **ADBI/DDI框架**
    

### 模拟点击

uiautomator ：很多模拟点击软件基于这个，跟xposed结合开发比较合适。

### frida安装

[https://www.jianshu.com/p/bab4f4714d98](https://www.jianshu.com/p/bab4f4714d98)

## 安卓源码

### 搭建源码编译流程：[https://mp.weixin.qq.com/s/uFllernXiZHdd3fg4nwpYQ](https://mp.weixin.qq.com/s/uFllernXiZHdd3fg4nwpYQ)

### 源码镜像地址：

翻墙：[https://xn--4gq62f52gdss.com/#/knowledge](https://xn--4gq62f52gdss.com/#/knowledge)

git查看仓库地址：git remote -v

[Camera2](https://mirrors.tuna.tsinghua.edu.cn/git/AOSP/platform/packages/apps/Camera2.git)的镜像地址：

git clone [https://mirrors.tuna.tsinghua.edu.cn/git/AOSP/platform/packages/apps/Camera2.git](https://mirrors.tuna.tsinghua.edu.cn/git/AOSP/platform/packages/apps/Camera2.git)

对应的系统app有：

实际地址需要翻墙：[https://android.googlesource.com/platform/](https://android.googlesource.com/platform/)

可以国内镜像查看源码：

[https://mirrors.tuna.tsinghua.edu.cn/help/AOSP/](https://mirrors.tuna.tsinghua.edu.cn/help/AOSP/)

[https://cs.android.com/](https://cs.android.com/)

[https://cs.android.com/android/platform/superproject/?hl=zh-cn](https://cs.android.com/android/platform/superproject/?hl=zh-cn)

[https://android.googlesource.com/](https://android.googlesource.com/)

[http://aospxref.com/android-11.0.0\_r21/](http://aospxref.com/android-11.0.0_r21/)

安卓framework和apps的代码都是一起的

framework的客户端代码：aosp/android-11.0.0\_r46/frameworks/base/core/java/android/app/Activity.java

framework的服务端代码：aosp/android-11.0.0\_r46/frameworks/base/services/core/java/com/android/server/am/ActivityManagerService.java

系统应用安装包地址：aosp/android-11.0.0\_r46/packages/apps/Car/Launcher/src/com/android/car/carlauncher/AppGridActivity.java