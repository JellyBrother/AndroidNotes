### 项目初始化报错
gradle命令版本不对，检查电脑path环境变量配置
构建工具版本要跟开发工具里面的gradle的版本一致
删除gralde里面的build缓存，刷新依赖，重新构建，还是不行，重启开发工具

### 获取token失败。后台用长token请求成功，用短token失败。
移动端使用短token访问，后台需要解析成长token，后台使用的是第三方jar包，解析失败。

### 内网开发activity的时候，不继承base会闪退，云化版本没问题。
原因是内网的base有主题设置，各个控件有的布局文件有引用这些配置，不集成的话，会找不到。
继承base或者添加这个主题。

### 图片加、载不一致，pc端和ios端是一样的，安卓原生浏览器不一样，自己的应用又不一样。
后台提供的图片地址是百度上面搜索给到的地址，里面很多乱码。需要对地址进行转码，并对一些字符进行替换处理。

### 主页点击后进详情，返回时显示空白
缓存逻辑处理问题。首先，缓存只存第一屏数据，并且是不为空，有数据的才缓存。页面显示的时候，需要对数据进行判空处理。
需要区分第一次加载，下拉加载，上拉加载，页面恢复的时候加载。

### 附件下载多次查看，提示文件格式错误，文件无法打开
原因是下载的时候加密了，设置为不加密。

### 附件下载多次查看，提示附件不存在
知识启动的时候，删除了文件夹，需要添加例外

### RMS文件打开失败，要提示无权限。
公司内网生成的rms文档，然后上云外网去打开怎么可能，不存在这种场景，服务器物理都是隔离的。

### 设置弹框的时候，控件宽高没有根据屏幕大小变化。
获取手机的宽高在初始化进行，切换横竖屏的时候，没有再次赋值。

### handle使用
handle使用静态类，并且弱引用。
发送消息使用十进制，禁用十六进制。
消息处理可以try，防止异常。
default:使用 break; 禁用super.handleMessage(msg);

### 上下文使用
尽量使用activity，安卓分屏适配要使用activity来startActivity，不能使用context否则会崩溃。

### 不继承base会闪退。
原因是base有主题设置，各个控件有的布局文件有引用这些配置，不集成的话，会找不到。
继承base或者不继承base，自主添加这个主题。

### long类型强转成int类型，会导致结果是负数
先确认到底是不是long类型，不要强转。

### 解决内存泄露：
1、对OOM和ANR进行监控、日志打印、日志上传到服务器，进行持续跟踪改进。
2、使用LeakCanary和Profiler工具进行分析。
3、在基类的onDestory方法中遍历view，进行资源清理，移除handler消息。各个页面销毁掉时候，要销毁各个监听。
4、再application中监控到内存低的时候，对资源进行清理。
5、图片加载使用565而不是888格式，宽高根据控件宽高展示，而不是屏幕宽高。
6、单例模式尽量使用application上下文。
7、Handler使用静态和弱引用，default的时候直接break掉。

### 富文本编辑器方案有
1、原生使用span进行处理，但是耗性能，而且兼容性不好。
2、原生使用adapter，先定义好数据模型，根据用户输入内容来刷新列表数据，很难处理点击事件和焦点。
3、使用H5的富文本编辑器，也有兼容性问题需要处理。

### 富文本编辑器总结
1、写博客软键盘弹出监听和横竖屏切换使用OnGlobalLayoutListener
2、软键盘弹出会遮挡输入框，需要在弹出的时候监听布局高度，手动设置布局高度，并且防止多次调用。

###  H5富文本编辑器有图片内容的时候，有些输入法会联想出OBJ字符，替换前后的输入内容
解决方法：光标后移，并且图片宽度全屏，这样输入的时候就不会在图片后面联想出OBJ了，
最终获取编辑器内容的时候需要替换OBJ，并且其他的输入框也要替换，因为用户可以复制编辑器内容粘贴到输入框。
H5富文本编辑器点击的时候，弹出软键盘，需要让编辑器滑动到点击位置。当点击在底部的时候，H5需要延时200才能滑动到底部。

### 输入法连接定位跟踪
IInputConnectionWrapper发送消息InputConnectionWrapper处理
点击联想输入
点击键盘按键输入
beginBatchEdit-setComposingText-endBatchEdit-getTextBeforeCursor-getTextAfterCursor
编辑器输入文字，有时候删除不了，因为不同的机器和不同的输入法对删除操作兼容不好，
需要监听IInputConnectionWrapper的 deleteSurroundingText 和 deleteSurroundingTextInCodePoints方法 来自行处理删除事件

### 控件销毁的方法onDetachedFromWindow里面不要随意进行销毁动作，会有异常
activity的生命是大于控件的，控件销毁了，activity不一定销毁，所以最好是放activity里面执行销毁操作。

### 写博客页面点击拍照返回写博客页面，会异常。
原因是拍照页面定义的风格是全屏，跟写博客页面不一样，导致重新设置页面的时候，高度设置为了0
写博客页面监听布局改变的时候，会出现多次。
拍照页面隐藏的时候onPause，写博客页面恢复onResume，布局监听生效。
拍照页面销毁的时候onDestroy，写博客页面布局监听生效。
需要在监听生效里面，处理高度为0的情况，为0的时候，不重新布局。
















































